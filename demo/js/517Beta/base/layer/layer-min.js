!function(h,d){var a=true,e="../layer/",f,g,i={iE6:!-[1]&&!h.XMLHttpRequest,times:0};i.getPath=function(){var k=document.scripts||f("script"),j=k[k.length-1].src;return j.substring(0,j.lastIndexOf("/")+1)};i.load=function(){a&&(e=this.getPath())};this.layer={v:"1.6.0",ready:function(k){var j="#layerCss";return f(j).ready(function(){k()})},alert:function(l,j,m,k){return f.layer({dialog:{msg:l,type:(j===true||j===d)?3:-1,yes:k},title:m,area:["auto","auto"]})},confirm:function(l,k,m,n,j){return f.layer({dialog:{msg:l,type:(j===true||j===d)?3:-1,btns:2,yes:k,no:n},title:m})},msg:function(l,k,j,m){(l==""||l==d)&&(l="&nbsp;");k===d&&(k=2);return f.layer({dialog:{msg:l,type:j},time:k,title:["",false],closeBtn:["",false],end:function(){m&&m()}})},warning:function(k,l,j){return f.layer({dialog:{msg:k,type:(j===true||j===d)?0:-1,yes:l}})},tips:function(l,k,o,n,j,m){return f.layer({type:4,closeBtn:[0,true],shade:false,time:o,maxWidth:n,tips:{msg:l,guide:j,follow:k,style:m}})},load:function(l,n,k,j){var m=true;n===3&&(m=false);return f.layer({time:l,shade:[0.3,"#000",k],loading:{type:n,msg:j},border:[10,0.3,"#000",m],type:3,title:["",false],closeBtn:[0,false]})},followTips:function(k,j){return f.layer({type:5,followTips:{msg:k,follow:j}})}};var b=function(k){i.times++;this.index=i.times;var j=this.config;this.config=f.extend({},j,k);this.config.dialog=f.extend({},j.dialog,k.dialog);this.config.page=f.extend({},j.page,k.page);this.config.iframe=f.extend({},j.iframe,k.iframe);this.config.loading=f.extend({},j.loading,k.loading);this.config.tips=f.extend({},j.tips,k.tips);this.config.followTips=f.extend({},j.followTips,k.followTips);this.creat()};b.pt=b.prototype;b.pt.config={type:0,shade:[0.3,"#000",true],shadeClose:false,fix:true,move:[".xubox_title",true],moveOut:false,title:["信息",true],offset:["200px","50%"],area:["310px","auto"],closeBtn:[0,true],time:0,bgcolor:"#fff",border:[8,0.3,"#000",true],zIndex:19891014,maxWidth:400,dialog:{btns:1,btn:["确定","取消"],type:3,msg:"",yes:function(j){layer.close(j)},no:function(j){layer.close(j)}},page:{dom:"#xulayer",html:"",url:""},iframe:{src:"http://sentsin.com"},loading:{type:0,msg:""},tips:{msg:"",follow:"",guide:0,isGuide:true,style:["background-color:#FF9900; color:#fff;","#FF9900"]},followTips:{msg:"",follow:""},success:function(j){},close:function(j){layer.close(j)},end:function(){}};b.pt.type=["dialog","page","iframe","loading","tips"];b.pt.space=function(p){var p=p||"",j=this.index,l=this.config,r=l.dialog,o=this.dom,q=r.type===-1?"":'<span class="xubox_msg xulayer_png32 xubox_msgico xubox_msgtype'+r.type+'"></span>',k=['<div class="xubox_dialog">'+q+'<span class="xubox_msg xubox_text" style="'+(q?"":"padding-left:20px")+'">'+r.msg+"</span></div>",'<div class="xubox_page">'+p+"</div>",'<iframe allowtransparency="true" id="'+o.ifr+""+j+'" name="'+o.ifr+""+j+'" onload="$(this).removeClass(\'xubox_load\');" class="'+o.ifr+'" frameborder="0" src="'+l.iframe.src+'"></iframe>','<div class="xubox_loadingMain"><span class="xubox_loading xubox_loading_'+l.loading.type+'"></span><span class="xubox_loadmsg">'+l.loading.msg+"</span></div>",'<div class="xubox_tips" style="'+l.tips.style[0]+'"><div class="xubox_tipsMsg">'+l.tips.msg+'</div><i class="layerTipsG"></i></div>','<div class="xubox_followtips">'+l.followTips.msg+"</div>"],v="",m="",t=l.zIndex+j,w="z-index:"+t+"; background-color:"+l.shade[1]+"; opacity:"+l.shade[0]+"; filter:alpha(opacity="+l.shade[0]*100+");";l.shade[2]&&(v='<div times="'+j+'" id="xubox_shade'+j+'" class="xubox_shade" style="'+w+'"></div>');l.zIndex=t;var u="",s="",x="z-index:"+(t-1)+"; top:-"+l.border[0]+"px; left:-"+l.border[0]+"px;";l.border[3]&&(m='<div id="xubox_border'+j+'" class="xubox_border" style="'+x+'"></div>');l.closeBtn[1]&&(s='<a class="xubox_close xulayer_png32 xubox_close'+l.closeBtn[0]+'" href="javascript:;"></a>');l.title[1]&&(u='<h2 class="xubox_title"><em>'+l.title[0]+"</em></h2>");var n='<div times="'+j+'" showtime="'+l.time+'" style="z-index:'+t+'" id="'+o.lay+""+j+'" class="'+o.lay+'"><div style="background-color:'+l.bgcolor+"; z-index:"+t+'" class="xubox_main">'+k[l.type]+u+s+'<span class="xubox_botton"></span></div>'+m+"</div>";return[v,n]};b.pt.dom={lay:"xubox_layer",ifr:"xubox_iframe"};b.pt.creat=function(){var q=this,j="",l=this.config,s=l.dialog,t=q.config.title,m=q.dom;t.constructor===Array||(q.config.title=[t,true]);t===false&&(q.config.title=[t,false]);var r=l.page,p=f("body"),o=function(v){var v=v||"";j=q.space(v);p.append(j[0])};switch(l.type){case 1:if(r.html!==""){o('<div class="xuboxPageHtml">'+r.html+"</div>");p.append(j[1])}else{if(r.url!==""){o('<div class="xuboxPageHtml" id="xuboxPageHtml'+q.index+'">'+r.html+"</div>");p.append(j[1]);f.get(r.url,function(v){f("#xuboxPageHtml"+q.index).html(v);r.ok&&r.ok(v)})}else{if(f(r.dom).parents(".xubox_page").length==0){o();f(r.dom).show().wrap(j[1])}else{return}}}break;case 2:o();p.append(j[1]);break;case 3:l.title=["",false];l.area=["auto","auto"];l.closeBtn=["",false];f(".xubox_loadingMain")[0]&&layer.close(f(".xubox_loadingMain").parents("."+m.lay).attr("times"));o();p.append(j[1]);break;case 4:l.title=["",false];l.area=["auto","auto"];l.fix=false;l.border=false;f(".xubox_tips")[0]&&layer.close(f(".xubox_tips").parents("."+m.lay).attr("times"));o();p.append(j[1]);f("#"+m.lay+i.times).find(".xubox_close").css({top:5,right:5});break;case 5:l.title=["",false];l.area=["auto","auto"];l.border=false;l.fix=false;l.shade=false;l.closeBtn=["",false];f(".xubox_followtips")[0]&&layer.close(f(".xubox_followtips").parents("."+m.lay).attr("times"));o();p.append(j[1]);break;default:l.title[1]||(l.area=["auto","auto"]);f(".xubox_dialog")[0]&&layer.close(f(".xubox_dialog").parents("."+m.lay).attr("times"));o();p.append(j[1]);break}var k=i.times;this.layerS=f("#xubox_shade"+k);this.layerB=f("#xubox_border"+k);this.layerE=f("#"+m.lay+k);var n=this.layerE;this.layerMian=n.find(".xubox_main");this.layerTitle=n.find(".xubox_title");this.layerText=n.find(".xubox_text");this.layerPage=n.find(".xubox_page");this.layerBtn=n.find(".xubox_botton");if(l.offset[1].indexOf("px")!=-1){var u=parseInt(l.offset[1])}else{if(l.offset[1]=="50%"){var u=l.offset[1]}else{var u=parseInt(l.offset[1])/100*g.width()}}n.css({left:u+l.border[0],width:l.area[0],height:l.area[1]});l.fix?n.css({top:parseInt(l.offset[0])+l.border[0]}):n.css({top:parseInt(l.offset[0])+g.scrollTop()+l.border[0],position:"absolute"});if(l.type==0&&l.title[1]){switch(s.btns){case 0:q.layerBtn.html("").hide();break;case 2:q.layerBtn.html('<a href="javascript:;" class="xubox_yes xubox_botton2">'+s.btn[0]+'</a><a href="javascript:;" class="xubox_no xubox_botton3">'+s.btn[1]+"</a>");break;default:q.layerBtn.html('<a href="javascript:;" class="xubox_yes xubox_botton1">'+s.btn[0]+"</a>")}}if(n.css("left")==="auto"){n.hide();setTimeout(function(){n.show();q.set(k)},500)}else{q.set(k)}l.time<=0||q.autoclose();this.callback()};b.pt.set=function(t){var p=this,o=this.layerE,G=this.config,A=G.dialog,n=G.page,B=p.dom;p.autoArea(t);if(G.title[1]){i.iE6&&p.layerTitle.css({width:o.outerWidth()})}else{G.type!=4&&o.find(".xubox_close").addClass("xubox_close1")}o.attr({type:p.type[G.type]});switch(G.type){case 1:o.find(n.dom).addClass("layer_pageContent");G.shade[2]&&o.css({zIndex:G.zIndex+1});G.title[1]&&p.layerPage.css({top:p.layerTitle.outerHeight()});break;case 2:var q=o.find("."+B.ifr),x=o.height();q.addClass("xubox_load").css({width:o.width()});G.title[1]?q.css({top:p.layerTitle.height(),height:x-p.layerTitle.height()}):q.css({top:0,height:x});i.iE6&&q.attr("src",G.iframe.src);break;case 4:var v=f(G.tips.follow),z=v.offset().top,u=z-o.outerHeight();var k=v.offset().left,m=k,y=G.tips.style[1];var F=o.outerHeight(),r=o.outerWidth(),C=o.find(".layerTipsG");r>G.maxWidth&&o.width(G.maxWidth);if(G.tips.guide===1){var s=g.width()-m-r-o.outerWidth()-10,u=z;if(s>0){m=m+v.outerWidth()+10;C.removeClass("layerTipsL").addClass("layerTipsR").css({"border-right-color":y})}else{m=m-o.outerWidth()-10;C.removeClass("layerTipsR").addClass("layerTipsL").css({"border-left-color":y})}}else{if(u-g.scrollTop()-12<=0){u=z+F+10;C.removeClass("layerTipsT").addClass("layerTipsB").css({"border-bottom-color":y})}else{u=u-10;C.removeClass("layerTipsB").addClass("layerTipsT").css({"border-top-color":y})}}G.tips.isGuide||C.remove();o.css({top:u,left:m});break;case 5:var l=f(G.followTips.follow);var E=l.outerHeight();var D=l.outerWidth();var j=l.offset().left;var w=l.offset().top;f(document).mousemove(function(J){var I=J.originalEvent.x||J.originalEvent.layerX||0;var H=J.originalEvent.y||J.originalEvent.layerY||0;if(J.pageX||J.pageY){I=J.pageX;H=J.pageY}else{I=J.clientX+document.body.scrollLeft-document.body.clientLeft;H=J.clientY+document.body.scrollTop-document.body.clientTop}if(I<j||I>(j+D)||H<w||H>(E+w)){f(".xubox_followtips").parents(".xubox_layer").css("display","none")}else{J.preventDefault();if(j<=I<=(j+D)&&w<=H<=(E+w)){f(".xubox_followtips").parents(".xubox_layer").css("display","block");o.css({top:H+10,left:I+40})}}});break;default:this.layerMian.css({"background-color":"#fff"});if(G.title[1]){this.layerText.css({paddingTop:18+p.layerTitle.outerHeight()})}else{o.find(".xubox_msgico").css({top:"10px"});p.layerText.css({marginTop:12})}break}this.move()};b.pt.autoArea=function(k){var t=this,r=t.layerE,m=t.config,u=m.page,o=t.layerMian,l=t.layerBtn,p=t.layerText,j=t.layerPage,s=t.layerB,n;if(m.area[0]==="auto"&&o.outerWidth()>=m.maxWidth){r.css({width:m.maxWidth})}m.title[1]?n=t.layerTitle.innerHeight():n=0;switch(m.type){case 0:var w=l.find("a"),x=p.outerHeight()+20;if(w.length>0){var q=w.outerHeight()+20}else{var q=0}break;case 1:var q=0,x=f(u.dom).outerHeight();m.area[0]==="auto"&&r.css({width:j.outerWidth()});if(u.html!==""){x=j.outerHeight()}break;case 3:var v=f(".xubox_loadingMain"),q=0;var x=v.outerHeight()*2+15;break}(m.area[1]==="auto")&&(m.type==3?"":o.css({height:n+x+q}));s.css({width:r.outerWidth()+2*m.border[0],height:r.outerHeight()+2*m.border[0]});(i.iE6&&m.area[0]!="auto")&&o.css({width:r.outerWidth()});(m.offset[1]==="50%"||m.offset[1]=="")&&(m.type!==4)?r.css({marginLeft:-r.outerWidth()/2}):r.css({marginLeft:0})};b.pt.move=function(){var q=this,k=this.config,r=q.layerE.find(k.move[0]),o,p,n=q.dom;var m,j,l,t=0,s=0;k.move[1]&&r.attr("move","ok");k.move[1]?q.layerE.find(k.move[0]).css({cursor:"move"}):q.layerE.find(k.move[0]).css({cursor:"auto"});f(k.move[0]).on("mousedown",function(y){y.preventDefault();if(f(this).attr("move")==="ok"){p=true;o=f(this).parents("."+n.lay);var w=o.offset().left,x=o.offset().top,v=o.width()-6,u=o.height()-6;if(!f("#xubox_moves")[0]){f("body").append('<div id="xubox_moves" class="xubox_moves" style="left:'+w+"px; top:"+x+"px; width:"+v+"px; height:"+u+'px; z-index:2147483584"></div>')}l=f("#xubox_moves");m=y.pageX-l.position().left;j=y.pageY-l.position().top;t=g.scrollLeft();o.css("position")!=="fixed"||(s=g.scrollTop())}});f(document).mousemove(function(z){if(p){z.preventDefault();var v=z.pageX-m;if(o.css("position")==="fixed"){var y=z.pageY-j}else{var y=z.pageY-j}if(!k.moveOut){var u=g.width()-l.outerWidth()-k.border[0],x=g.scrollTop(),w=k.border[0]+x;v<k.border[0]&&(v=k.border[0]);v>u&&(v=u);y<w&&(y=w);y>g.height()-l.outerHeight()-k.border[0]+x&&(y=g.height()-l.outerHeight()-k.border[0]+x)}l.css({left:v,top:y})}}).mouseup(function(){try{if(p){if(parseInt(o.css("margin-left"))==0){var v=parseInt(l.css("left"))}else{var v=parseInt(l.css("left"))+(-parseInt(o.css("margin-left")))}o.css("position")==="fixed"||(v=v-o.parent().offset().left);o.css({left:v,top:parseInt(l.css("top"))-s});l.remove()}p=false}catch(u){p=false}k.moveEnd&&k.moveEnd()})};b.pt.autoclose=function(){var k=this,l=this.config.time;var j=function(){l--;if(l===0){layer.close(k.index);clearInterval(k.autotime)}};this.autotime=setInterval(j,1000)};i.config={end:{}};b.pt.callback=function(){this.openLayer();var l=this,m=this.layerE,j=this.config,k=j.dialog;this.config.success(m);i.iE6&&this.IE6();m.find(".xubox_close").off("click").on("click",function(n){n.preventDefault();j.close(l.index)});m.find(".xubox_yes").off("click").on("click",function(n){n.preventDefault();k.yes(l.index)});m.find(".xubox_no").off("click").on("click",function(n){n.preventDefault();k.no(l.index)});this.layerS.off("click").on("click",function(n){n.preventDefault();l.config.shadeClose&&layer.close(l.index)});i.config.end[this.index]=j.end};b.pt.IE6=function(){var k=this,o=this.layerE,j=f("select"),n=k.dom;var m=o.offset().top;if(this.config.fix){var l=function(){o.css({top:f(document).scrollTop()+m})}}else{var l=function(){o.css({top:m})}}l();g.scroll(l);f.each(j,function(p,q){var r=f(this);if(!r.parents("."+n.lay)[0]){r.css("display")=="none"||r.attr({layer:"1"}).hide()}});this.reselect=function(){f.each(j,function(p,q){var r=f(this);if(!r.parents("."+n.lay)[0]){(r.attr("layer")==1&&f("."+n.lay).length<1)&&r.removeAttr("layer").show()}})}};b.pt.openLayer=function(){var j=this,k=j.dom;layer.index=i.times;layer.autoArea=function(l){return j.autoArea(l)};layer.getIndex=function(l){return f(l).parents("."+k.lay).attr("times")};layer.getChildFrame=function(l,m){m=m||f("."+k.ifr).parents("."+k.lay).attr("times");return f("#"+k.lay+m).find("."+k.ifr).contents().find(l)};layer.getFrameIndex=function(l){return f(l?"#"+l:"."+k.ifr).parents("."+k.lay).attr("times")};layer.iframeAuto=function(p){p=p||f("."+k.ifr).parents("."+k.lay).attr("times");var m=this.getChildFrame("body",p).outerHeight(),l=f("#"+k.lay+p),o=l.find(".xubox_title"),q=0;!o||(q=o.height());l.css({height:m+q});var n=-parseInt(f("#xubox_border"+p).css("top"));f("#xubox_border"+p).css({height:m+2*n+q});f("#"+k.ifr+p).css({height:m})};layer.close=function(m){var o=f("#"+k.lay+m),l=f("#xubox_moves, #xubox_shade"+m);if(o.attr("type")==j.type[1]){if(o.find(".xuboxPageHtml")[0]){o.remove()}else{o.find(".xubox_close,.xubox_botton,.xubox_title,.xubox_border").remove();for(var n=0;n<3;n++){o.find(".layer_pageContent").unwrap().hide()}}}else{document.all&&o.find("#"+k.ifr+m).remove();o.remove()}l.remove();i.iE6&&j.reselect();typeof i.config.end[m]==="function"&&i.config.end[m]();delete i.config.end[m]};layer.loadClose=function(){var m=f(".xubox_loadingMain").parents("."+k.lay),l=m.attr("times");layer.close(l)};layer.shift=function(s,r){var m=j.config,q=i.iE6,o=j.layerE,t=0,p=g.width(),l=g.height();(m.offset[1]=="50%"||m.offset[1]=="")?t=o.outerWidth()/2:t=o.outerWidth();var n={t:{top:m.border[0]},b:{top:l-o.outerHeight()-m.border[0]},cl:t+m.border[0],ct:-o.outerHeight(),cr:p-t-m.border[0],fn:function(){q&&j.IE6()}};switch(s){case"left-top":o.css({left:n.cl,top:n.ct}).animate(n.t,r,n.fn);break;case"right-top":o.css({left:n.cr,top:n.ct}).animate(n.t,r,n.fn);break;case"left-bottom":o.css({left:n.cl,top:l}).animate(n.b,r,n.fn);break;case"right-bottom":o.css({left:n.cr,top:l}).animate(n.b,r,n.fn);break}};layer.setMove=function(){return j.move()};layer.area=function(n,m){var q=[f("#"+k.lay+n),f("#xubox_border"+n)],p=q[0].attr("type"),l=q[0].find(".xubox_main"),r=q[0].find(".xubox_title");if(p===j.type[1]||p===j.type[2]){q[0].css(m);if(q[1][0]){q[1].css({width:m.width-2*parseInt(q[1].css("left")),height:m.height-2*parseInt(q[1].css("top"))})}l.css({height:m.height});if(p===j.type[2]){var o=q[0].find("iframe");o.css({width:m.width,height:r?m.height-r.outerHeight():m.height})}if(q[0].css("margin-left")!=="0px"){m.hasOwnProperty("top")&&q[0].css({top:m.top-(q[1][0]&&parseInt(q[1].css("top")))});m.hasOwnProperty("left")&&q[0].css({left:m.left+q[0].outerWidth()/2-(q[1][0]&&parseInt(q[1].css("left")))});q[0].css({marginLeft:-q[0].outerWidth()/2})}}};layer.closeAll=function(){var l=f("."+k.lay);f.each(l,function(){var m=f(this).attr("times");layer.close(m)})};layer.zIndex=j.config.zIndex;layer.setTop=function(l){layer.zIndex=parseInt(l[0].style.zIndex),setZindex=function(){layer.zIndex++;l.css("z-index",layer.zIndex+1)};l.on("mousedown",setZindex);return layer.zIndex}};i.run=function(){f=jQuery;g=f(h);this.load();f.layer=function(k){var j=new b(k);return j.index}};i.run()}(window);
